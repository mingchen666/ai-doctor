import { getThemeTokens, getThemeManager } from '../common/theme/ThemeManager'

@Component
export struct Header {
  @State themeTokens = getThemeTokens()
  @State isDark: boolean = false
  onOpenSessions?: () => void
  onOpenGlobalSettings?: () => void
  onOpenConsultationSettings?: () => void

  build() {
    Row() {
      // Left side: Logo and title
      Row() {
        Image($r('app.media.logo'))
          .width(28)
          .height(28)

        Text('AI åŒ»ç–—ä¼šè¯Šé¢æ¿')
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .margin({ left: 8 })

        Text('ã€æœ¬å†…å®¹ä»…ä¾›å‚è€ƒï¼Œèº«ä½“ä¸é€‚å°½æ—©å°±åŒ»ã€‘')
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .fontColor(this.themeTokens.errorColor)
          .margin({ left: 8 })
      }
      .gap(8)
      .alignItems(VerticalAlign.Center)

      Blank()

      // Right side: Action buttons
      Row() {
        Button('é—®è¯Šåˆ—è¡¨', { type: ButtonType.Normal, stateEffect: true })
          .onClick(() => this.onOpenSessions?.())

        Button('å…¨å±€è®¾ç½®', { type: ButtonType.Normal, stateEffect: true })
          .onClick(() => this.onOpenGlobalSettings?.())

        Button(this.isDark ? 'â˜€ï¸' : 'ðŸŒ™', { type: ButtonType.Circle, stateEffect: true })
          .width(40)
          .height(40)
          .onClick(() => {
            this.isDark = !this.isDark
            getThemeManager().setDarkMode(this.isDark)
            this.themeTokens = getThemeTokens()
          })

        Button('é—®è¯Šè®¾ç½®', { type: ButtonType.Capsule, stateEffect: true })
          .backgroundColor(this.themeTokens.primaryColor)
          .onClick(() => this.onOpenConsultationSettings?.())
      }
      .gap(8)
      .alignItems(VerticalAlign.Center)
    }
    .width('100%')
    .height(64)
    .padding({ left: 16, right: 16 })
    .alignItems(VerticalAlign.Center)
    .backgroundColor(this.themeTokens.backgroundPrimary)
    .borderBottomColor(this.themeTokens.borderColor)
    .borderBottomWidth(1)
  }
}
